{"componentChunkName":"component---src-templates-blog-post-js","path":"/energy-prediction-lpz/","result":{"data":{"site":{"siteMetadata":{"title":"sysid blog","siteUrl":"https://sysid.github.io","social":{"twitter":""}}},"mdx":{"id":"810c1a87-d300-5661-ae78-ea1976267ff3","excerpt":"Energy Forecast for a full scale Vehicle Plant Energy forecasting is based on time series analysis.\nThere are many techniques for analysing and forecasting time series, e.g. ARIMA, linear regressionâ€¦","body":"function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\n/* @jsxRuntime classic */\n\n/* @jsx mdx */\nvar _frontmatter = {\n  \"title\": \"Energy Forecast for a full-scale Vehicle Plant\",\n  \"date\": \"2017-05-28T22:12:03.284Z\",\n  \"description\": \"\",\n  \"tags\": [\"python\", \"math\", \"learning\"]\n};\nvar layoutProps = {\n  _frontmatter: _frontmatter\n};\nvar MDXLayout = \"wrapper\";\nreturn function MDXContent(_ref) {\n  var components = _ref.components,\n      props = _objectWithoutProperties(_ref, [\"components\"]);\n\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"div\", {\n    className: styles[\"logo\"]\n  }, mdx(\"img\", {\n    src: plant,\n    className: styles[\"logo-plant\"],\n    alt: \"Plant LPZ\"\n  })), mdx(\"h1\", null, \"Energy Forecast for a full scale Vehicle Plant\"), mdx(\"p\", null, \"Energy forecasting is based on time series analysis.\\nThere are many techniques for analysing and forecasting time series, e.g. ARIMA, linear regression and deep learning.\\nTo tackle the challenge at hand a linear regression will be the benchmark model aganst which deep learning models will be tested. In particular a multi layer perceptron (MLP) and recurrent\\nneural network (RNN), i.e.  Long-Short Time Memory (LSTM) model will be applied.\"), mdx(\"h2\", null, \"Business Domain\"), mdx(\"p\", null, \"Energy forecasting is a tricky challenge because many factors might influence the final energy demand of a complex system\\nlike a large manufacturing plant. Especially when the plant employs\\nnot only energy consumers but also energy producers like CHPs and wind farms or energy reservoirs like battery farms.\\nSignificant factors to take into account:\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"production plan\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"CHP energy production\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"weather, i.e. temperature, wind\")), mdx(\"h2\", null, \"Data Preparation\"), mdx(\"p\", null, \"In order to apply the described techniques the problem has to be framed as a supervised learning problem. The data at hand is an hourly measurment of energy consumption\\nin 2015 as well as associated production plans and weather data. This results to a multivariate time series. The variable to forecast is energy consumption for the next 48 hours.\"), mdx(\"p\", null, \"For application in a LSTM neural network with \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, mdx(\"code\", _extends({\n    parentName: \"strong\"\n  }, {\n    \"className\": \"language-text\"\n  }), \"tanh\")), \" non-linearity the data need to be scaled to the interval \", \"[-1,1]\", \". Furthermore we split it into a training set (80%) and a test set (20%).\"), mdx(\"p\", null, \"For forecasting different tactics can be applied.\"), mdx(\"ol\", null, mdx(\"li\", {\n    parentName: \"ol\"\n  }, mdx(\"strong\", {\n    parentName: \"li\"\n  }, \"Linear\"), \" regression: the timesteps are taken as independent from the past an only dependent on the feature vector at time t=0.\"), mdx(\"li\", {\n    parentName: \"ol\"\n  }, mdx(\"strong\", {\n    parentName: \"li\"\n  }, \"MLP\"), \": similar to linear regression with respect to feature preparation.\"), mdx(\"li\", {\n    parentName: \"ol\"\n  }, mdx(\"strong\", {\n    parentName: \"li\"\n  }, \"LSTM\"), \": the timesteps are dependent on their predecessors and therefor the see-behind window is a hyperparameter to be chosen for the model.\")), mdx(\"p\", null, \"For this analysis the LSTM model will have two variants with regards to the lookback window:\"), mdx(\"ol\", null, mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"the entire dataset will be taken as sequence length, i.e. the LSTM context will be build over the entire time series. In Keras this results in a statfull LSTM network with batch-size 1 (online learning)..\"), mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"a lookback window of 14days will be taken. This allows for batch-size > 0 and a stateless LSTM network.\")), mdx(\"p\", null, \"For the non RNN models also information from previous timesteps can be encoded into the feature vector by just putting the values of past timesteps as additional features into the feature vector.\\nHere we also use the information of the last 14 days to be consistent within our model choices.\"), mdx(\"p\", null, \"For all models the following parameters/features have been selected:\"), mdx(\"ol\", null, mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"energy consumption\"), mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"air temperature\"), mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"wind speed\"), mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"wind direction\"), mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"production plan\")), mdx(\"p\", null, \"This results in a feature vector for the linear models of dimension 1872:\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"lookback: 14days\", mdx(\"em\", {\n    parentName: \"li\"\n  }, \"24h\"), \"5features\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"lookforward: 2days\", mdx(\"em\", {\n    parentName: \"li\"\n  }, \"24h\"), \"4features (5th parameter is the energy and is the label in our models to be forecasted)\")), mdx(\"h4\", null, \"Timestamp Challenges\"), mdx(\"p\", null, \"Keeping the timestamps correct after all the data transformations is a special challenge which requires careful handling. The following diagram illustrates the topic. Left you can see the resulting dataset for a lookback window of 14days whereas on the right for a lookback window of 1hour. In order to compare results, the inverse date transformations have to take this into account.\"), mdx(\"div\", {\n    className: styles[\"logo\"]\n  }, mdx(\"img\", {\n    src: temporal_adjustment,\n    className: styles[\"logo-plant\"],\n    alt: \"Temporal Adjustment\"\n  })), mdx(\"h2\", null, \"Model\"), mdx(\"p\", null, \"We predict the entire 48 hours with one prediction in order to avoid instabilities introduced by step-by-step forecasting and then using the forecast as feature for the next forecast.\"), mdx(\"p\", null, \"For the linear regression the venerable \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"http://scikit-learn.org/stable/\"\n  }), \"scikit-learn\"), \" library is used.\\nFor all the deep-learning \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://keras.io/\"\n  }), \"KERAS\"), \" and \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://www.tensorflow.org/\"\n  }), \"TENSORFLOW\"), \" are the tools of choice.\"), mdx(\"div\", {\n    className: styles[\"logo\"]\n  }, mdx(\"img\", {\n    src: models,\n    className: styles[\"logo-plant\"],\n    alt: \"models\"\n  })), mdx(\"p\", null, \"The MLP model has got 1.4 Mio parameters, so its capacity is much higher then the LSTM.\\nThis gives already a first hint towards further optimization of model setup.\"), mdx(\"h2\", null, \"Result\"), mdx(\"p\", null, \"Quality of forecast is measured as MSE (mean squared error). All plots show an arbitrary point in time of the test set with 14days\\nin the past and 2 days forecast. Every model is compared to the naive linear regression (red line).\"), mdx(\"h3\", null, \"LTSM\"), mdx(\"div\", {\n    className: styles[\"logo\"]\n  }, mdx(\"img\", {\n    src: rnn,\n    className: styles[\"logo-plant\"],\n    alt: \"RNN\"\n  })), mdx(\"p\", null, \"The LTSM model overall shows an MSE of 0.025 on the test set.\"), mdx(\"p\", null, \"The red box shows an outlier in the linear regression.\\nIt seems like the linear model did not pick up a significant feature like production plan properly.\\nThe LSTM did a better job here.\"), mdx(\"h3\", null, \"MLP\"), mdx(\"div\", {\n    className: styles[\"logo\"]\n  }, mdx(\"img\", {\n    src: mlp,\n    className: styles[\"logo-plant\"],\n    alt: \"MLP\"\n  })), mdx(\"p\", null, \"The MLP model overall shows an MSE of 0.063 on the test set.\"), mdx(\"h3\", null, \"Conclusion\"), mdx(\"p\", null, \"Although both deep learning approaches can predict the shape of the time series well, the LSTM model exhibits higher accuracy.\\nSince the model capacity is much lower, this was a surprising outcome.\"), mdx(\"p\", null, \"However both deep learning approaches seem struggle to match the quality of a simple linear regression forecast.\\nDue to time contraints no hyperparameter or model tuning has taken place. There are many areas for potential improvements, e.g.\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"detailed feature preparation, especially production plans\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"exploration of more neural network configurations (number of layers, number of timesteps, number of neurons, \\u2026)\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"hyperparameter tuning (regularization, learning rates, optimiziers, \\u2026)\")), mdx(\"p\", null, \"Thanks for reading.\"));\n}\n;\nMDXContent.isMDXComponent = true;","frontmatter":{"title":"Energy Forecast for a full-scale Vehicle Plant","date":"May 28, 2017","description":"","tags":["python","math","learning"]},"fields":{"slug":"/energy-prediction-lpz/","readingTime":{"minutes":4.645}}}},"pageContext":{"slug":"/energy-prediction-lpz/","previous":{"fields":{"slug":"/fishy-affine-transformation/"},"frontmatter":{"title":"Fishy Affine Transformation","tags":["python","math"]}},"next":{"fields":{"slug":"/munggoggo/"},"frontmatter":{"title":"Munggoggo: A modern message based async agent framework","tags":["python","async"]}}}},"staticQueryHashes":["2841359383","4035129850"]}