<!DOCTYPE html>
<html lang="en-us">
<head>

    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />

  	<meta property="og:title" content=" energy consumption prediction &middot;  " />
  	<meta property="og:site_name" content="" />
  	<meta property="og:url" content="https://sysid.github.io/post/energy-consumption-prediction/" />

    
  	<meta property="og:type" content="article" />

    <meta property="og:article:published_time" content="2017-03-05T19:39:50&#43;01:00" />

    
    <meta property="og:article:tag" content="sysid" />
    
    <meta property="og:article:tag" content="ml" />
    
    <meta property="og:article:tag" content="machine learning" />
    
    <meta property="og:article:tag" content="deep learning" />
    
    

  <title>
     energy consumption prediction &middot;  
  </title>

    <meta name="description" content="" />

    <meta name="HandheldFriendly" content="True" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <link rel="shortcut icon" href="https://sysid.github.io/images/favicon.ico">
	  <link rel="apple-touch-icon" href="https://sysid.github.io/images/apple-touch-icon.png" />

    <link rel="stylesheet" type="text/css" href="https://sysid.github.io/css/screen.css" />
    <link rel="stylesheet" type="text/css" href="https://sysid.github.io/css/nav.css" />
    <link rel="stylesheet" type="text/css" href="//fonts.googleapis.com/css?family=Merriweather:300,700,700italic,300italic|Open+Sans:700,400|Inconsolata" />

    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.6.0/styles/default.min.css">
    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.6.0/highlight.min.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>

    
      
          <link href="https://sysid.github.io/index.xml" rel="alternate" type="application/rss+xml" title="" />
      
      
    
    <meta name="generator" content="Hugo 0.16" />

    <link rel="canonical" href="https://sysid.github.io/post/energy-consumption-prediction/" />

    
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-79101-12', 'auto');
      ga('send', 'pageview');

    </script>
    

    
</head>
<body class="nav-closed">

  <div class="nav">
    <h3 class="nav-title">Menu</h3>
    <a href="#" class="nav-close">
        <span class="hidden">Close</span>
    </a>
    <ul>
        
        
        
            
            <li class="nav-opened" role="presentation">
            	<a href="https://sysid.github.io/">My Blog</a>
            </li>
        
            
            <li class="nav-opened" role="presentation">
            	<a href="https://sysid.github.io/about">About me</a>
            </li>
        
            
            <li class="nav-opened" role="presentation">
            	<a href="https://sysid.github.io/post/be-a-prophet-for-airline-data/">Facebook&#39;s Prophet forecasting library</a>
            </li>
        
            
            <li class="nav-opened" role="presentation">
            	<a href="https://sysid.github.io/post/adding-problem/">LSTM versus MLP for timeseries</a>
            </li>
        
            
            <li class="nav-opened nav-current" role="presentation">
            	<a href="https://sysid.github.io/post/energy-consumption-prediction/">energy consumption prediction</a>
            </li>
        
    </ul>
    
    
    <a class="subscribe-button icon-feed" href="https://sysid.github.io/index.xml">Subscribe</a>
    
</div>
<span class="nav-cover"></span>


 <div class="site-wrapper">




<header class="main-header post-head no-cover">
  <nav class="main-nav clearfix">


  
  
      <a class="menu-button" href="#"><span class="burger">&#9776;</span><span class="word">Menu</span></a>
  
  </nav>
</header>



<main class="content" role="main">




  <article class="post post">

    <header class="post-header">
        <h1 class="post-title">energy consumption prediction</h1>
        <small></small>

        <section class="post-meta">
        
          <time class="post-date" datetime="2017-03-05T19:39:50&#43;01:00">
            Mar 5, 2017
          </time>
        
         
          <span class="post-tag small"><a href="https://sysid.github.io/tags/sysid/">#sysid</a></span>
         
          <span class="post-tag small"><a href="https://sysid.github.io/tags/ml/">#ml</a></span>
         
          <span class="post-tag small"><a href="https://sysid.github.io/tags/machine-learning/">#machine learning</a></span>
         
          <span class="post-tag small"><a href="https://sysid.github.io/tags/deep-learning/">#deep learning</a></span>
         
        </section>
    </header>

    <section class="post-content">
      

<h1 id="energy-consumption-prediction-with-recurrent-neural-networks">Energy Consumption Prediction with Recurrent Neural Networks</h1>

<p>We look at 52 European energy markets and their power consumption patterns.</p>

<p>The forecast technology will be based on recurrent neural networks.
While there are many other, also simpler techniques (e.g. ARIMA, Facebook&rsquo;s Prophet, time-shifting) this is an attempt to harness machine learning capabilities to predict future consumption patterns.</p>

<p>The data consists of hourly values of country/region power consumption of 52 countries over the course from 1.1.2014 - 31.12.2018,
which gives us 43000 data points per country. Of course the data consists only of
real world data up to 2016 and then forcast data from a commercial data provider up until end of 2018.</p>

<p>For our purposes we assume the entire time series as real data and try to predict time intervals with machine learning techniques.</p>

<h4 id="energy-consumption-germany">Energy Consumption Germany</h4>

<p>
<figure >
    
        <img src="https://sysid.github.io/images/consumption/consumption_DE.png" />
    
    
</figure>

<br>
The data is generally quite regular and periodic, so this seems to be an adequate use case for RNN prediction.</p>

<h2 id="the-problem">The Problem</h2>

<p>The problem we are facing is Multivariate time series regression.</p>

<p>In order to run the code, we make sure that the data matrix is a numpy array of size
<strong><code>T x N</code></strong> where <strong><code>T</code></strong> is the length of time series and <strong><code>N</code></strong> is the number of them.</p>

<p>Technically, with RNNs we should pass the entire history of time series and RNNs should be able to capture
the patterns over long period of time.</p>

<p>Another approach is to break long sequences into smaller pieces. The size of window determines the longest
patterns in time that can possibly be captured by RNN. You need to select the window size according to the
expected length of temporal patterns.</p>

<p>For our analysis we set the period length at 80 datapoints which is equivalent to an 80hour time forecast.</p>

<p>So the entire &lsquo;history&rsquo; for our RNN consists of 80 hours of energy consumption.</p>

<h2 id="setup">Setup</h2>

<p>I tested three different models based on Gated Recurrent Units (GRU) as RNN units.</p>

<p>The dataset, a <strong><code>43000x52</code></strong> matrix, was sequenced into a <strong><code>464x80x52</code></strong> tensor for training and a <strong><code>82x80x52</code></strong> tensor for testing.
This gives us 82 potential time periods of 80 hours per market for testing.</p>

<p>The <strong><code>464x80x52</code></strong> tensor is equivalent to 464 different timeseries per market, each of length 80.</p>

<p>The model has been trained on the training set with <strong><code>100</code></strong> epochs and a <strong><code>batch_size of 64</code></strong>. Training took about 2 minutes per model on a NVIDIA GTX780.</p>

<p>To test the accuracy I will here only present a visual comparision between the predicted curve and the real data. To this end a time sequence from the test set
and a market has been chosen randomly and plotted.</p>

<h2 id="results">Results</h2>

<h3 id="model-1">Model 1</h3>

<p>
<figure >
    
        <img src="https://sysid.github.io/images/consumption/model1.png" />
    
    
</figure>


<figure >
    
        <img src="https://sysid.github.io/images/consumption/model1_i10_m08.png" />
    
    
</figure>
</p>

<h3 id="model-2">Model 2</h3>

<p>
<figure >
    
        <img src="https://sysid.github.io/images/consumption/model2.png" />
    
    
</figure>


<figure >
    
        <img src="https://sysid.github.io/images/consumption/model2_i27_m50.png" />
    
    
</figure>
</p>

<h3 id="model-3">Model 3</h3>

<p>
<figure >
    
        <img src="https://sysid.github.io/images/consumption/model3.png" />
    
    
</figure>


<figure >
    
        <img src="https://sysid.github.io/images/consumption/model3_i46_m50.png" />
    
    
</figure>
</p>

<h2 id="summary">Summary</h2>

<p>I did not bother to retransform the axis scales to the original units MW and Date because here I am only interested in a qualitative asssessment of
forecast quality.</p>

<p>Surprising for me was to see, that all three models more or less deliver similar good results in projecting the time dependency of the energy consumption.</p>

<p>This is remarkable since there has been no hyperparamter tuning at all. The models were fit &lsquo;out of the box&rsquo;.</p>

<p>Since this result has been achieved with very little work, using RNNs for this kind of time series prediction seems to be effective.</p>

<p>Thanks for reading.</p>

    </section>


  <footer class="post-footer">


    

    





<section class="author">
  <h4><a href="https://sysid.github.io/">TW</a></h4>
  
  <p>Read <a href="https://sysid.github.io/">more posts</a> by this author.</p>
  
  <div class="author-meta">
    <span class="author-location icon-location">Germany</span>
    
  </div>
</section>



    
<section class="share">
  <h4>Share this post</h4>
  <a class="icon-twitter" style="font-size: 1.4em" href="https://twitter.com/share?text=energy%20consumption%20prediction&amp;url=https%3a%2f%2fsysid.github.io%2fpost%2fenergy-consumption-prediction%2f"
      onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
      <span class="hidden">Twitter</span>
  </a>
  <a class="icon-facebook" style="font-size: 1.4em" href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fsysid.github.io%2fpost%2fenergy-consumption-prediction%2f"
      onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;">
      <span class="hidden">Facebook</span>
  </a>
  <a class="icon-pinterest" style="font-size: 1.4em" href="http://pinterest.com/pin/create/button/?url=https%3a%2f%2fsysid.github.io%2fpost%2fenergy-consumption-prediction%2f&amp;description=energy%20consumption%20prediction"
      onclick="window.open(this.href, 'pinterest-share','width=580,height=296');return false;">
      <span class="hidden">Pinterest</span>
  </a>
  <a class="icon-google-plus" style="font-size: 1.4em" href="https://plus.google.com/share?url=https%3a%2f%2fsysid.github.io%2fpost%2fenergy-consumption-prediction%2f"
     onclick="window.open(this.href, 'google-plus-share', 'width=490,height=530');return false;">
      <span class="hidden">Google+</span>
  </a>
</section>



    

<div id="disqus_thread"></div>
<script type="text/javascript">
  var disqus_shortname = 'sysid';
  var disqus_url = 'https:\/\/sysid.github.io\/post\/energy-consumption-prediction\/';
  (function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>




  </footer>
</article>

</main>
    <footer class="site-footer clearfix">
        <section class="copyright"><a href=""></a> All rights reserved - 2016</section>
        
        <section class="poweredby">Proudly generated by <a class="icon-hugo" href="http://gohugo.io">HUGO</a>, with <a class="icon-theme" href="https://github.com/vjeantet/hugo-theme-casper">Casper</a> theme</section>
        
    </footer>
    </div>
    <script type="text/javascript" src="https://sysid.github.io/js/jquery.js"></script>
    <script type="text/javascript" src="https://sysid.github.io/js/jquery.fitvids.js"></script>
    <script type="text/javascript" src="https://sysid.github.io/js/index.js"></script>
    
</body>
</html>

