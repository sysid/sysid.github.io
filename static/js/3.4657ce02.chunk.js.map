{"version":3,"sources":["routes/posts/2017-05-28-energy-prediction-lpz/document.mdx","routes/posts/2017-05-28-energy-prediction-lpz/plant_lpz.png","routes/posts/2017-05-28-energy-prediction-lpz/temporal_adjustment.png","routes/posts/2017-05-28-energy-prediction-lpz/mlp.png","routes/posts/2017-05-28-energy-prediction-lpz/rnn.png","routes/posts/2017-05-28-energy-prediction-lpz/document.module.css"],"names":["readingTime","text","minutes","time","words","layoutProps","MDXLayout","MDXContent","_ref","components","props","Object","_home_tw_dev_sysid_blog_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_objectWithoutProperties__WEBPACK_IMPORTED_MODULE_0__","_mdx_js_react__WEBPACK_IMPORTED_MODULE_2__","assign","mdxType","className","styles","src","plant","alt","id","parentName","temporal_adjustment","href","rnn","mlp","isMDXComponent","tableOfContents","arguments","length","undefined","level","title","children","frontMatter","module","exports","__webpack_require__","p","logo","logo-navi","logo-react","logo-plant","Index-logo-react-spin","Index-logo-navi-spin"],"mappings":"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","file":"static/js/3.4657ce02.chunk.js","sourcesContent":["\nimport React from 'react'\nimport { mdx } from '@mdx-js/react'\nexport const readingTime = {\"text\":\"5 min read\",\"minutes\":4.52,\"time\":271200,\"words\":904}\n/* @jsx mdx */\nimport plant from './plant_lpz.png'\nimport temporal_adjustment from './temporal_adjustment.png'\nimport mlp from './mlp.png'\nimport rnn from './rnn.png'\nimport styles from './document.module.css'\n\nconst makeShortcode = name => function MDXDefaultShortcode(props) {\n  console.warn(\"Component \" + name + \" was not imported, exported, or provided by MDXProvider as global scope\")\n  return <div {...props}/>\n};\n\nconst layoutProps = {\n  \n};\nconst MDXLayout = \"wrapper\"\nexport default function MDXContent({\n  components,\n  ...props\n}) {\n  return <MDXLayout {...layoutProps} {...props} components={components} mdxType=\"MDXLayout\">\n\n    <div className={styles[\"logo\"]}>\n      <img src={plant} className={styles[\"logo-plant\"]} alt=\"Plant LPZ\" />\n    </div>\n    <h1 {...{\n      \"id\": \"energy-forecast-for-a-full-scale-vehicle-plant\"\n    }}>{`Energy Forecast for a full scale Vehicle Plant`}</h1>\n    <p>{`Energy forecasting is based on time series analysis.\nThere are many techniques for analysing and forecasting time series, e.g. ARIMA, linear regression and deep learning.\nTo tackle the challenge at hand a linear regression will be the benchmark model aganst which deep learning models will be tested. In particular a multi layer perceptron (MLP) and recurrent\nneural network (RNN), i.e.  Long-Short Time Memory (LSTM) model will be applied.`}</p>\n    <h2 {...{\n      \"id\": \"business-domain\"\n    }}>{`Business Domain`}</h2>\n    <p>{`Energy forecasting is a tricky challenge because many factors might influence the final energy demand of a complex system\nlike a large manufacturing plant. Especially when the plant employs\nnot only energy consumers but also energy producers like CHPs and wind farms or energy reservoirs like battery farms.\nSignificant factors to take into account:`}</p>\n    <ul>\n      <li parentName=\"ul\">{`production plan`}</li>\n      <li parentName=\"ul\">{`CHP energy production`}</li>\n      <li parentName=\"ul\">{`weather, i.e. temperature, wind`}</li>\n    </ul>\n    <h2 {...{\n      \"id\": \"data-preparation\"\n    }}>{`Data Preparation`}</h2>\n    <p>{`In order to apply the described techniques the problem has to be framed as a supervised learning problem. The data at hand is an hourly measurment of energy consumption\nin 2015 as well as associated production plans and weather data. This results to a multivariate time series. The variable to forecast is energy consumption for the next 48 hours.`}</p>\n    <p>{`For application in a LSTM neural network with `}<strong parentName=\"p\"><inlineCode parentName=\"strong\">{`tanh`}</inlineCode></strong>{` non-linearity the data need to be scaled to the interval `}{`[-1,1]`}{`. Furthermore we split it into a training set (80%) and a test set (20%).`}</p>\n    <p>{`For forecasting different tactics can be applied.`}</p>\n    <ol>\n      <li parentName=\"ol\"><strong parentName=\"li\">{`Linear`}</strong>{` regression: the timesteps are taken as independent from the past an only dependent on the feature vector at time t=0.`}</li>\n      <li parentName=\"ol\"><strong parentName=\"li\">{`MLP`}</strong>{`: similar to linear regression with respect to feature preparation.`}</li>\n      <li parentName=\"ol\"><strong parentName=\"li\">{`LSTM`}</strong>{`: the timesteps are dependent on their predecessors and therefor the see-behind window is a hyperparameter to be chosen for the model.`}</li>\n    </ol>\n    <p>{`For this analysis the LSTM model will have two variants with regards to the lookback window:`}</p>\n    <ol>\n      <li parentName=\"ol\">{`the entire dataset will be taken as sequence length, i.e. the LSTM context will be build over the entire time series. In Keras this results in a statfull LSTM network with batch-size 1 (online learning)..`}</li>\n      <li parentName=\"ol\">{`a lookback window of 14days will be taken. This allows for batch-size > 0 and a stateless LSTM network.`}</li>\n    </ol>\n    <p>{`For the non RNN models also information from previous timesteps can be encoded into the feature vector by just putting the values of past timesteps as additional features into the feature vector.\nHere we also use the information of the last 14 days to be consistent within our model choices.`}</p>\n    <p>{`For all models the following parameters/features have been selected:`}</p>\n    <ol>\n      <li parentName=\"ol\">{`energy consumption`}</li>\n      <li parentName=\"ol\">{`air temperature`}</li>\n      <li parentName=\"ol\">{`wind speed`}</li>\n      <li parentName=\"ol\">{`wind direction`}</li>\n      <li parentName=\"ol\">{`production plan`}</li>\n    </ol>\n    <p>{`This results in a feature vector for the linear models of dimension 1872:`}</p>\n    <ul>\n      <li parentName=\"ul\">{`lookback: 14days`}<em parentName=\"li\">{`24h`}</em>{`5features`}</li>\n      <li parentName=\"ul\">{`lookforward: 2days`}<em parentName=\"li\">{`24h`}</em>{`4features (5th parameter is the energy and is the label in our models to be forecasted)`}</li>\n    </ul>\n    <h4 {...{\n      \"id\": \"timestamp-challenges\"\n    }}>{`Timestamp Challenges`}</h4>\n    <p>{`Keeping the timestamps correct after all the data transformations is a special challenge which requires careful handling. The following diagram illustrates the topic. Left you can see the resulting dataset for a lookback window of 14days whereas on the right for a lookback window of 1hour. In order to compare results, the inverse date transformations have to take this into account.`}</p>\n    <div className={styles[\"logo\"]}>\n      <img src={temporal_adjustment} className={styles[\"logo-plant\"]} alt=\"Temporal Adjustment\" />\n    </div>\n    <h2 {...{\n      \"id\": \"model\"\n    }}>{`Model`}</h2>\n    <p>{`We predict the entire 48 hours with one prediction in order to avoid instabilities introduced by step-by-step forecasting and then using the forecast as feature for the next forecast.`}</p>\n    <p>{`For the linear regression the venerable `}<a parentName=\"p\" {...{\n        \"href\": \"http://scikit-learn.org/stable/\"\n      }}>{`scikit-learn`}</a>{` library is used.\nFor all the deep-learning `}<a parentName=\"p\" {...{\n        \"href\": \"https://keras.io/\"\n      }}>{`KERAS`}</a>{` and `}<a parentName=\"p\" {...{\n        \"href\": \"https://www.tensorflow.org/\"\n      }}>{`TENSORFLOW`}</a>{` are the tools of choice.`}</p>\n    <p>{`{{< figure src=\"/images/prognose/models.png\" title=\"\" >}}`}</p>\n    <p>{`The MLP model has got 1.4 Mio parameters, so its capacity is much higher then the LSTM.\nThis gives already a first hint towards further optimization of model setup.`}</p>\n    <h2 {...{\n      \"id\": \"result\"\n    }}>{`Result`}</h2>\n    <p>{`Quality of forecast is measured as MSE (mean squared error). All plots show an arbitrary point in time of the test set with 14days\nin the past and 2 days forecast. Every model is compared to the naive linear regression (red line).`}</p>\n    <h3 {...{\n      \"id\": \"ltsm\"\n    }}>{`LTSM`}</h3>\n    <div className={styles[\"logo\"]}>\n      <img src={rnn} className={styles[\"logo-plant\"]} alt=\"RNN\" />\n    </div>\n    <p>{`The LTSM model overall shows an MSE of 0.025 on the test set.`}</p>\n    <p>{`The red box shows an outlier in the linear regression.\nIt seems like the linear model did not pick up a significant feature like production plan properly.\nThe LSTM did a better job here.`}</p>\n    <h3 {...{\n      \"id\": \"mlp\"\n    }}>{`MLP`}</h3>\n    <div className={styles[\"logo\"]}>\n      <img src={mlp} className={styles[\"logo-plant\"]} alt=\"MLP\" />\n    </div>\n    <p>{`The MLP model overall shows an MSE of 0.063 on the test set.`}</p>\n    <h3 {...{\n      \"id\": \"conclusion\"\n    }}>{`Conclusion`}</h3>\n    <p>{`Although both deep learning approaches can predict the shape of the time series well, the LSTM model exhibits higher accuracy.\nSince the model capacity is much lower, this was a surprising outcome.`}</p>\n    <p>{`However both deep learning approaches seem struggle to match the quality of a simple linear regression forecast.\nDue to time contraints no hyperparameter or model tuning has taken place. There are many areas for potential improvements, e.g.`}</p>\n    <ul>\n      <li parentName=\"ul\">{`detailed feature preparation, especially production plans`}</li>\n      <li parentName=\"ul\">{`exploration of more neural network configurations (number of layers, number of timesteps, number of neurons, …)`}</li>\n      <li parentName=\"ul\">{`hyperparameter tuning (regularization, learning rates, optimiziers, …)`}</li>\n    </ul>\n    <p>{`Thanks for reading.`}</p>\n    </MDXLayout>;\n}\n\n;\nMDXContent.isMDXComponent = true;\nexport const tableOfContents = (components={}) => [\n  {\n    id: \"business-domain\",\n    level: 2,\n    title: \"Business Domain\",\n    children: [\n        \n      ]\n  },\n{\n    id: \"data-preparation\",\n    level: 2,\n    title: \"Data Preparation\",\n    children: [\n        \n      ]\n  },\n{\n    id: \"model\",\n    level: 2,\n    title: \"Model\",\n    children: [\n        \n      ]\n  },\n{\n    id: \"result\",\n    level: 2,\n    title: \"Result\",\n    children: [\n        {\n              id: \"ltsm\",\n              level: 3,\n              title: \"LTSM\",\n              children: [\n                      \n                    ]\n            },\n      {\n              id: \"mlp\",\n              level: 3,\n              title: \"MLP\",\n              children: [\n                      \n                    ]\n            },\n      {\n              id: \"conclusion\",\n              level: 3,\n              title: \"Conclusion\",\n              children: [\n                      \n                    ]\n            }\n      ]\n  }\n]\n\nexport const frontMatter = {}\n\n","module.exports = __webpack_public_path__ + \"static/media/plant_lpz.e9c11026.png\";","module.exports = __webpack_public_path__ + \"static/media/temporal_adjustment.a0f9a4a5.png\";","module.exports = __webpack_public_path__ + \"static/media/mlp.a3d4bbea.png\";","module.exports = __webpack_public_path__ + \"static/media/rnn.b799641a.png\";","// extracted by mini-css-extract-plugin\nmodule.exports = {\"logo\":\"document_logo__ebI6r\",\"logo-navi\":\"document_logo-navi__2cHsD\",\"logo-react\":\"document_logo-react__JhkE5\",\"logo-plant\":\"document_logo-plant__1ORN_\",\"Index-logo-react-spin\":\"document_Index-logo-react-spin__1ufuE\",\"Index-logo-navi-spin\":\"document_Index-logo-navi-spin__2ubZJ\"};"],"sourceRoot":""}